<?php
	include('../../dbFunctions.php');

	class TransportPlace {

		function select($tipoTte) {

			$mysqli = new mysqli("localhost", "root", "MissingX", "lost2found");

			if (mysqli_connect_errno()) {
			    printf("Connect failed: %s\n", mysqli_connect_error());
			    exit();
			}
			$query = "SELECT DISTINCT linea FROM lugar_transporte WHERE tipoTte = 'metro'";
			$result = $mysqli->query($query);

			while($row = $result->fetch_array())	{
			    $rows[] = $row;
			}

			$rawdata = array();
			$i = 0;

			foreach($rows as $row)    {
			//var_dump($rows[$i]);
			    $rawdata[$i] = $rows[$i];
			    //echo $rawdata["$i"];
				//var_dump($rows[$i]);
			    $i++;
			}
			var_dump($rawdata[$i]);
			//$result->close();

			/* close connection */
			$mysqli->close();

		}

			/*$connection = connectDB();

			$resultado = mysqli_query($connection, "SELECT DISTINCT linea FROM lugar_transporte WHERE tipoTte = ?");
			mysqli_stmt_bind_param($sql, "s", $tipoTte);
			echo "1";
			var_dump($resultado);
			printf(mysqli_num_rows($resultado));

			mysqli_free_result($resultado);

			/*$sql = mysqli_prepare($connection, "SELECT DISTINCT linea FROM lugar_transporte WHERE tipoTte = ?");
			mysqli_stmt_bind_param($sql, "s", $tipoTte);

			$query = $sql->execute();

			if(!$query)
	                die();

			$result = $sql->store_result();

			$realresult = $sql->bind_result($linea);

			/*while($fila = $result->fetch_row()) {
                               printf ($fila[0], $fila[1]);
                        }*/


			/*$rawdata = array();

			$sql->fetch();

			for($i = 0; $i < 14; $i++) {
				//echo $i;

				$rawdata[$i] = utf8_encode($linea);
			}

		        disconnectDB($connection);
	                return $rawdata;*/
		


		/*function select($tipoTte) {
			$connection = connectDB();

			$consulta = "SELECT DISTINCT linea FROM lugar_transporte WHERE tipoTte = $tipoTte";

			if ($resultado = $mysqli->query($consulta)) {

			    /* obtener el array de objetos 
			    while ($fila = $resultado->fetch_row()) {
			        printf ("%s (%s)\n", $fila[0], $fila[1]);
			    }

			    /* liberar el conjunto de resultados
			    $resultado->close();
			}

			/* cerrar la conexiÃ³n 
			disconnectDB($connection);
			return $rawdata;
		}*/

		/**
		 *	Insert a place in the database.
		 *	@param announceType
		 *	@param currentTime
		 *	@param announceDateText
		 *	@param announceHourText
		 *	@param model
		 *	@param brand
		 *	@param color
		 *	@param announceCategorie
		 */
	    function insert($line, $station, $placeId) {
	        $connection = connectDB();
		//var_dump($line);
		//var_dump($station);
		//var_dump($placeId);
		$sql = mysqli_prepare($connection, "INSERT INTO lugar_transporte (idLugarTte, linea, estacion) VALUES (?, ?, ?)");
		//var_dump($sql);
		//echo $sql;
		mysqli_stmt_bind_param($sql, "iss", $placeId, $line, $station);

	        $query = $sql->execute();
		//var_dump($query);
	        if(!$query)
	            echo "incorrect";
	        else
	            echo "correct";

	        disconnectDB($connection);
	        return $query;
	    }
	}
?>
